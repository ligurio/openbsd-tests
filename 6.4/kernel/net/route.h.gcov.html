<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - 6.4 - net/route.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">net</a> - route.h<span style="font-size: 80%;"> (source / <a href="route.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">6.4</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">3</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2018-10-19 03:25:38</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*      $OpenBSD: route.h,v 1.172 2018/07/12 16:07:35 florian Exp $     */</a>
<span class="lineNum">       2 </span>            : /*      $NetBSD: route.h,v 1.9 1996/02/13 22:00:49 christos Exp $       */
<span class="lineNum">       3 </span>            : 
<span class="lineNum">       4 </span>            : /*
<span class="lineNum">       5 </span>            :  * Copyright (c) 1980, 1986, 1993
<span class="lineNum">       6 </span>            :  *      The Regents of the University of California.  All rights reserved.
<span class="lineNum">       7 </span>            :  *
<span class="lineNum">       8 </span>            :  * Redistribution and use in source and binary forms, with or without
<span class="lineNum">       9 </span>            :  * modification, are permitted provided that the following conditions
<span class="lineNum">      10 </span>            :  * are met:
<span class="lineNum">      11 </span>            :  * 1. Redistributions of source code must retain the above copyright
<span class="lineNum">      12 </span>            :  *    notice, this list of conditions and the following disclaimer.
<span class="lineNum">      13 </span>            :  * 2. Redistributions in binary form must reproduce the above copyright
<span class="lineNum">      14 </span>            :  *    notice, this list of conditions and the following disclaimer in the
<span class="lineNum">      15 </span>            :  *    documentation and/or other materials provided with the distribution.
<span class="lineNum">      16 </span>            :  * 3. Neither the name of the University nor the names of its contributors
<span class="lineNum">      17 </span>            :  *    may be used to endorse or promote products derived from this software
<span class="lineNum">      18 </span>            :  *    without specific prior written permission.
<span class="lineNum">      19 </span>            :  *
<span class="lineNum">      20 </span>            :  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
<span class="lineNum">      21 </span>            :  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
<span class="lineNum">      22 </span>            :  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
<span class="lineNum">      23 </span>            :  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
<span class="lineNum">      24 </span>            :  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
<span class="lineNum">      25 </span>            :  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
<span class="lineNum">      26 </span>            :  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
<span class="lineNum">      27 </span>            :  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
<span class="lineNum">      28 </span>            :  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
<span class="lineNum">      29 </span>            :  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
<span class="lineNum">      30 </span>            :  * SUCH DAMAGE.
<span class="lineNum">      31 </span>            :  *
<span class="lineNum">      32 </span>            :  *      @(#)route.h     8.3 (Berkeley) 4/19/94
<span class="lineNum">      33 </span>            :  */
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : #ifndef _NET_ROUTE_H_
<span class="lineNum">      36 </span>            : #define _NET_ROUTE_H_
<span class="lineNum">      37 </span>            : 
<span class="lineNum">      38 </span>            : /*
<span class="lineNum">      39 </span>            :  * Kernel resident routing tables.
<span class="lineNum">      40 </span>            :  *
<span class="lineNum">      41 </span>            :  * The routing tables are initialized when interface addresses
<span class="lineNum">      42 </span>            :  * are set by making entries for all directly connected interfaces.
<span class="lineNum">      43 </span>            :  */
<span class="lineNum">      44 </span>            : 
<span class="lineNum">      45 </span>            : /*
<span class="lineNum">      46 </span>            :  * These numbers are used by reliable protocols for determining
<span class="lineNum">      47 </span>            :  * retransmission behavior and are included in the routing structure.
<span class="lineNum">      48 </span>            :  */
<span class="lineNum">      49 </span>            : struct rt_kmetrics {
<span class="lineNum">      50 </span>            :         u_int64_t       rmx_pksent;     /* packets sent using this route */
<span class="lineNum">      51 </span>            :         int64_t         rmx_expire;     /* lifetime for route, e.g. redirect */
<span class="lineNum">      52 </span>            :         u_int           rmx_locks;      /* Kernel must leave these values */
<span class="lineNum">      53 </span>            :         u_int           rmx_mtu;        /* MTU for this path */
<span class="lineNum">      54 </span>            : };
<span class="lineNum">      55 </span>            : 
<span class="lineNum">      56 </span>            : /*
<span class="lineNum">      57 </span>            :  * Huge version for userland compatibility.
<span class="lineNum">      58 </span>            :  */
<span class="lineNum">      59 </span>            : struct rt_metrics {
<span class="lineNum">      60 </span>            :         u_int64_t       rmx_pksent;     /* packets sent using this route */
<span class="lineNum">      61 </span>            :         int64_t         rmx_expire;     /* lifetime for route, e.g. redirect */
<span class="lineNum">      62 </span>            :         u_int           rmx_locks;      /* Kernel must leave these values */
<span class="lineNum">      63 </span>            :         u_int           rmx_mtu;        /* MTU for this path */
<span class="lineNum">      64 </span>            :         u_int           rmx_refcnt;     /* # references hold */
<span class="lineNum">      65 </span>            :         /* some apps may still need these no longer used metrics */
<span class="lineNum">      66 </span>            :         u_int           rmx_hopcount;   /* max hops expected */
<span class="lineNum">      67 </span>            :         u_int           rmx_recvpipe;   /* inbound delay-bandwidth product */
<span class="lineNum">      68 </span>            :         u_int           rmx_sendpipe;   /* outbound delay-bandwidth product */
<span class="lineNum">      69 </span>            :         u_int           rmx_ssthresh;   /* outbound gateway buffer limit */
<span class="lineNum">      70 </span>            :         u_int           rmx_rtt;        /* estimated round trip time */
<span class="lineNum">      71 </span>            :         u_int           rmx_rttvar;     /* estimated rtt variance */
<span class="lineNum">      72 </span>            :         u_int           rmx_pad;
<span class="lineNum">      73 </span>            : };
<span class="lineNum">      74 </span>            : 
<span class="lineNum">      75 </span>            : /*
<span class="lineNum">      76 </span>            :  * rmx_rtt and rmx_rttvar are stored as microseconds;
<span class="lineNum">      77 </span>            :  * RTTTOPRHZ(rtt) converts to a value suitable for use
<span class="lineNum">      78 </span>            :  * by a protocol slowtimo counter.
<span class="lineNum">      79 </span>            :  */
<span class="lineNum">      80 </span>            : #define RTM_RTTUNIT     1000000 /* units for rtt, rttvar, as units per sec */
<span class="lineNum">      81 </span>            : #define RTTTOPRHZ(r)    ((r) / (RTM_RTTUNIT / PR_SLOWHZ))
<span class="lineNum">      82 </span>            : 
<span class="lineNum">      83 </span>            : #include &lt;sys/queue.h&gt;
<span class="lineNum">      84 </span>            : #include &lt;net/rtable.h&gt;
<span class="lineNum">      85 </span>            : 
<span class="lineNum">      86 </span>            : /*
<span class="lineNum">      87 </span>            :  * We distinguish between routes to hosts and routes to networks,
<span class="lineNum">      88 </span>            :  * preferring the former if available.  For each route we infer
<span class="lineNum">      89 </span>            :  * the interface to use from the gateway address supplied when
<span class="lineNum">      90 </span>            :  * the route was entered.  Routes that forward packets through
<span class="lineNum">      91 </span>            :  * gateways are marked so that the output routines know to address the
<span class="lineNum">      92 </span>            :  * gateway rather than the ultimate destination.
<span class="lineNum">      93 </span>            :  */
<span class="lineNum">      94 </span>            : 
<span class="lineNum">      95 </span>            : struct rtentry {
<span class="lineNum">      96 </span>            : #if !defined(_KERNEL) &amp;&amp; !defined(ART)
<span class="lineNum">      97 </span>            :         struct  radix_node rt_nodes[2]; /* tree glue, and other values */
<span class="lineNum">      98 </span>            : #else
<span class="lineNum">      99 </span>            :         struct sockaddr *rt_dest;       /* destination */
<span class="lineNum">     100 </span>            :         SRPL_ENTRY(rtentry) rt_next;    /* Next multipath entry to our dst. */
<span class="lineNum">     101 </span>            : #endif
<span class="lineNum">     102 </span>            :         struct sockaddr *rt_gateway;    /* value */
<span class="lineNum">     103 </span>            :         struct ifaddr   *rt_ifa;        /* the answer: interface addr to use */
<span class="lineNum">     104 </span>            :         caddr_t          rt_llinfo;     /* pointer to link level info cache or
<span class="lineNum">     105 </span>            :                                            to an MPLS structure */
<span class="lineNum">     106 </span>            :         union {
<span class="lineNum">     107 </span>            :                 struct rtentry  *_nh;   /* implied entry for gatewayed routes */
<span class="lineNum">     108 </span>            :                 unsigned int     _ref;  /* # gatewayed caching this route */
<span class="lineNum">     109 </span>            :         } RT_gw;
<span class="lineNum">     110 </span>            : #define rt_gwroute       RT_gw._nh
<span class="lineNum">     111 </span>            : #define rt_cachecnt      RT_gw._ref
<span class="lineNum">     112 </span>            :         struct rtentry  *rt_parent;     /* If cloned, parent of this route. */
<span class="lineNum">     113 </span>            :         LIST_HEAD(, rttimer) rt_timer;  /* queue of timeouts for misc funcs */
<span class="lineNum">     114 </span>            :         struct rt_kmetrics rt_rmx;      /* metrics used by rx'ing protocols */
<span class="lineNum">     115 </span>            :         unsigned int     rt_ifidx;      /* the answer: interface to use */
<span class="lineNum">     116 </span>            :         unsigned int     rt_flags;      /* up/down?, host/net */
<span class="lineNum">     117 </span>            :         int              rt_refcnt;     /* # held references */
<span class="lineNum">     118 </span>            : #if defined(_KERNEL) || defined(ART)
<span class="lineNum">     119 </span>            :         int              rt_plen;       /* prefix length */
<span class="lineNum">     120 </span>            : #endif
<span class="lineNum">     121 </span>            :         uint16_t         rt_labelid;    /* route label ID */
<span class="lineNum">     122 </span>            :         uint8_t          rt_priority;   /* routing priority to use */
<span class="lineNum">     123 </span>            : };
<span class="lineNum">     124 </span>            : #define rt_use          rt_rmx.rmx_pksent
<span class="lineNum">     125 </span>            : #define rt_expire       rt_rmx.rmx_expire
<span class="lineNum">     126 </span>            : #define rt_locks        rt_rmx.rmx_locks
<span class="lineNum">     127 </span>            : #define rt_mtu          rt_rmx.rmx_mtu
<span class="lineNum">     128 </span>            : 
<span class="lineNum">     129 </span>            : /* bitmask values for rtm_flags */
<span class="lineNum">     130 </span>            : #define RTF_UP          0x1             /* route usable */
<span class="lineNum">     131 </span>            : #define RTF_GATEWAY     0x2             /* destination is a gateway */
<span class="lineNum">     132 </span>            : #define RTF_HOST        0x4             /* host entry (net otherwise) */
<span class="lineNum">     133 </span>            : #define RTF_REJECT      0x8             /* host or net unreachable */
<span class="lineNum">     134 </span>            : #define RTF_DYNAMIC     0x10            /* created dynamically (by redirect) */
<span class="lineNum">     135 </span>            : #define RTF_MODIFIED    0x20            /* modified dynamically (by redirect) */
<span class="lineNum">     136 </span>            : #define RTF_DONE        0x40            /* message confirmed */
<span class="lineNum">     137 </span>            : #define RTF_CLONING     0x100           /* generate new routes on use */
<span class="lineNum">     138 </span>            : #define RTF_MULTICAST   0x200           /* route associated to a mcast addr. */
<span class="lineNum">     139 </span>            : #define RTF_LLINFO      0x400           /* generated by ARP or ND */
<span class="lineNum">     140 </span>            : #define RTF_STATIC      0x800           /* manually added */
<span class="lineNum">     141 </span>            : #define RTF_BLACKHOLE   0x1000          /* just discard pkts (during updates) */
<span class="lineNum">     142 </span>            : #define RTF_PROTO3      0x2000          /* protocol specific routing flag */
<span class="lineNum">     143 </span>            : #define RTF_PROTO2      0x4000          /* protocol specific routing flag */
<span class="lineNum">     144 </span>            : #define RTF_ANNOUNCE    RTF_PROTO2      /* announce L2 entry */
<span class="lineNum">     145 </span>            : #define RTF_PROTO1      0x8000          /* protocol specific routing flag */
<span class="lineNum">     146 </span>            : #define RTF_CLONED      0x10000         /* this is a cloned route */
<span class="lineNum">     147 </span>            : #define RTF_CACHED      0x20000         /* cached by a RTF_GATEWAY entry */
<span class="lineNum">     148 </span>            : #define RTF_MPATH       0x40000         /* multipath route or operation */
<span class="lineNum">     149 </span>            : #define RTF_MPLS        0x100000        /* MPLS additional infos */
<span class="lineNum">     150 </span>            : #define RTF_LOCAL       0x200000        /* route to a local address */
<span class="lineNum">     151 </span>            : #define RTF_BROADCAST   0x400000        /* route associated to a bcast addr. */
<span class="lineNum">     152 </span>            : #define RTF_CONNECTED   0x800000        /* interface route */
<span class="lineNum">     153 </span>            : #define RTF_BFD         0x1000000       /* Link state controlled by BFD */
<span class="lineNum">     154 </span>            : 
<span class="lineNum">     155 </span>            : /* mask of RTF flags that are allowed to be modified by RTM_CHANGE */
<span class="lineNum">     156 </span>            : #define RTF_FMASK       \
<span class="lineNum">     157 </span>            :     (RTF_LLINFO | RTF_PROTO1 | RTF_PROTO2 | RTF_PROTO3 | RTF_BLACKHOLE | \
<span class="lineNum">     158 </span>            :      RTF_REJECT | RTF_STATIC | RTF_MPLS | RTF_BFD)
<span class="lineNum">     159 </span>            : 
<span class="lineNum">     160 </span>            : /* Routing priorities used by the different routing protocols */
<span class="lineNum">     161 </span>            : #define RTP_NONE        0       /* unset priority use sane default */
<span class="lineNum">     162 </span>            : #define RTP_LOCAL       1       /* local address routes (must be the highest) */
<span class="lineNum">     163 </span>            : #define RTP_CONNECTED   4       /* directly connected routes */
<span class="lineNum">     164 </span>            : #define RTP_STATIC      8       /* static routes base priority */
<span class="lineNum">     165 </span>            : #define RTP_EIGRP       28      /* EIGRP routes */
<span class="lineNum">     166 </span>            : #define RTP_OSPF        32      /* OSPF routes */
<span class="lineNum">     167 </span>            : #define RTP_ISIS        36      /* IS-IS routes */
<span class="lineNum">     168 </span>            : #define RTP_RIP         40      /* RIP routes */
<span class="lineNum">     169 </span>            : #define RTP_BGP         48      /* BGP routes */
<span class="lineNum">     170 </span>            : #define RTP_DEFAULT     56      /* routes that have nothing set */
<span class="lineNum">     171 </span>            : #define RTP_PROPOSAL_STATIC     57
<span class="lineNum">     172 </span>            : #define RTP_PROPOSAL_DHCLIENT   58
<span class="lineNum">     173 </span>            : #define RTP_PROPOSAL_SLAAC      59
<span class="lineNum">     174 </span>            : #define RTP_MAX         63      /* maximum priority */
<span class="lineNum">     175 </span>            : #define RTP_ANY         64      /* any of the above */
<span class="lineNum">     176 </span>            : #define RTP_MASK        0x7f
<span class="lineNum">     177 </span>            : #define RTP_DOWN        0x80    /* route/link is down */
<span class="lineNum">     178 </span>            : 
<span class="lineNum">     179 </span>            : /*
<span class="lineNum">     180 </span>            :  * Routing statistics.
<span class="lineNum">     181 </span>            :  */
<span class="lineNum">     182 </span>            : struct  rtstat {
<span class="lineNum">     183 </span>            :         u_int32_t rts_badredirect;      /* bogus redirect calls */
<span class="lineNum">     184 </span>            :         u_int32_t rts_dynamic;          /* routes created by redirects */
<span class="lineNum">     185 </span>            :         u_int32_t rts_newgateway;       /* routes modified by redirects */
<span class="lineNum">     186 </span>            :         u_int32_t rts_unreach;          /* lookups which failed */
<span class="lineNum">     187 </span>            :         u_int32_t rts_wildcard;         /* lookups satisfied by a wildcard */
<span class="lineNum">     188 </span>            : };
<span class="lineNum">     189 </span>            : 
<span class="lineNum">     190 </span>            : /*
<span class="lineNum">     191 </span>            :  * Routing Table Info.
<span class="lineNum">     192 </span>            :  */
<span class="lineNum">     193 </span>            : struct rt_tableinfo {
<span class="lineNum">     194 </span>            :         u_short rti_tableid;    /* routing table id */
<span class="lineNum">     195 </span>            :         u_short rti_domainid;   /* routing domain id */
<span class="lineNum">     196 </span>            : };
<span class="lineNum">     197 </span>            : 
<span class="lineNum">     198 </span>            : /*
<span class="lineNum">     199 </span>            :  * Structures for routing messages.
<span class="lineNum">     200 </span>            :  */
<span class="lineNum">     201 </span>            : struct rt_msghdr {
<span class="lineNum">     202 </span>            :         u_short rtm_msglen;     /* to skip over non-understood messages */
<span class="lineNum">     203 </span>            :         u_char  rtm_version;    /* future binary compatibility */
<span class="lineNum">     204 </span>            :         u_char  rtm_type;       /* message type */
<span class="lineNum">     205 </span>            :         u_short rtm_hdrlen;     /* sizeof(rt_msghdr) to skip over the header */
<span class="lineNum">     206 </span>            :         u_short rtm_index;      /* index for associated ifp */
<span class="lineNum">     207 </span>            :         u_short rtm_tableid;    /* routing table id */
<span class="lineNum">     208 </span>            :         u_char  rtm_priority;   /* routing priority */
<span class="lineNum">     209 </span>            :         u_char  rtm_mpls;       /* MPLS additional infos */
<span class="lineNum">     210 </span>            :         int     rtm_addrs;      /* bitmask identifying sockaddrs in msg */
<span class="lineNum">     211 </span>            :         int     rtm_flags;      /* flags, incl. kern &amp; message, e.g. DONE */
<span class="lineNum">     212 </span>            :         int     rtm_fmask;      /* bitmask used in RTM_CHANGE message */
<span class="lineNum">     213 </span>            :         pid_t   rtm_pid;        /* identify sender */
<span class="lineNum">     214 </span>            :         int     rtm_seq;        /* for sender to identify action */
<span class="lineNum">     215 </span>            :         int     rtm_errno;      /* why failed */
<span class="lineNum">     216 </span>            :         u_int   rtm_inits;      /* which metrics we are initializing */
<span class="lineNum">     217 </span>            :         struct  rt_metrics rtm_rmx; /* metrics themselves */
<span class="lineNum">     218 </span>            : };
<span class="lineNum">     219 </span>            : /* overload no longer used field */
<span class="lineNum">     220 </span>            : #define rtm_use rtm_rmx.rmx_pksent
<span class="lineNum">     221 </span>            : 
<span class="lineNum">     222 </span>            : #define RTM_VERSION     5       /* Up the ante and ignore older versions */
<span class="lineNum">     223 </span>            : 
<span class="lineNum">     224 </span>            : #define RTM_MAXSIZE     2048    /* Maximum size of an accepted route msg */
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span>            : /* values for rtm_type */
<span class="lineNum">     227 </span>            : #define RTM_ADD         0x1     /* Add Route */
<span class="lineNum">     228 </span>            : #define RTM_DELETE      0x2     /* Delete Route */
<span class="lineNum">     229 </span>            : #define RTM_CHANGE      0x3     /* Change Metrics or flags */
<span class="lineNum">     230 </span>            : #define RTM_GET         0x4     /* Report Metrics */
<span class="lineNum">     231 </span>            : #define RTM_LOSING      0x5     /* Kernel Suspects Partitioning */
<span class="lineNum">     232 </span>            : #define RTM_REDIRECT    0x6     /* Told to use different route */
<span class="lineNum">     233 </span>            : #define RTM_MISS        0x7     /* Lookup failed on this address */
<span class="lineNum">     234 </span>            : #define RTM_RESOLVE     0xb     /* req to resolve dst to LL addr */
<span class="lineNum">     235 </span>            : #define RTM_NEWADDR     0xc     /* address being added to iface */
<span class="lineNum">     236 </span>            : #define RTM_DELADDR     0xd     /* address being removed from iface */
<span class="lineNum">     237 </span>            : #define RTM_IFINFO      0xe     /* iface going up/down etc. */
<span class="lineNum">     238 </span>            : #define RTM_IFANNOUNCE  0xf     /* iface arrival/departure */
<span class="lineNum">     239 </span>            : #define RTM_DESYNC      0x10    /* route socket buffer overflow */
<span class="lineNum">     240 </span>            : #define RTM_INVALIDATE  0x11    /* Invalidate cache of L2 route */
<span class="lineNum">     241 </span>            : #define RTM_BFD         0x12    /* bidirectional forwarding detection */
<span class="lineNum">     242 </span>            : #define RTM_PROPOSAL    0x13    /* proposal for netconfigd */
<span class="lineNum">     243 </span>            : #define RTM_CHGADDRATTR 0x14    /* address attribute change */
<span class="lineNum">     244 </span>            : 
<span class="lineNum">     245 </span>            : #define RTV_MTU         0x1     /* init or lock _mtu */
<span class="lineNum">     246 </span>            : #define RTV_HOPCOUNT    0x2     /* init or lock _hopcount */
<span class="lineNum">     247 </span>            : #define RTV_EXPIRE      0x4     /* init or lock _expire */
<span class="lineNum">     248 </span>            : #define RTV_RPIPE       0x8     /* init or lock _recvpipe */
<span class="lineNum">     249 </span>            : #define RTV_SPIPE       0x10    /* init or lock _sendpipe */
<span class="lineNum">     250 </span>            : #define RTV_SSTHRESH    0x20    /* init or lock _ssthresh */
<span class="lineNum">     251 </span>            : #define RTV_RTT         0x40    /* init or lock _rtt */
<span class="lineNum">     252 </span>            : #define RTV_RTTVAR      0x80    /* init or lock _rttvar */
<span class="lineNum">     253 </span>            : 
<span class="lineNum">     254 </span>            : /*
<span class="lineNum">     255 </span>            :  * Bitmask values for rtm_addrs.
<span class="lineNum">     256 </span>            :  */
<span class="lineNum">     257 </span>            : #define RTA_DST         0x1     /* destination sockaddr present */
<span class="lineNum">     258 </span>            : #define RTA_GATEWAY     0x2     /* gateway sockaddr present */
<span class="lineNum">     259 </span>            : #define RTA_NETMASK     0x4     /* netmask sockaddr present */
<span class="lineNum">     260 </span>            : #define RTA_GENMASK     0x8     /* cloning mask sockaddr present */
<span class="lineNum">     261 </span>            : #define RTA_IFP         0x10    /* interface name sockaddr present */
<span class="lineNum">     262 </span>            : #define RTA_IFA         0x20    /* interface addr sockaddr present */
<span class="lineNum">     263 </span>            : #define RTA_AUTHOR      0x40    /* sockaddr for author of redirect */
<span class="lineNum">     264 </span>            : #define RTA_BRD         0x80    /* for NEWADDR, broadcast or p-p dest addr */
<span class="lineNum">     265 </span>            : #define RTA_SRC         0x100   /* source sockaddr present */
<span class="lineNum">     266 </span>            : #define RTA_SRCMASK     0x200   /* source netmask present */
<span class="lineNum">     267 </span>            : #define RTA_LABEL       0x400   /* route label present */
<span class="lineNum">     268 </span>            : #define RTA_BFD         0x800   /* bfd present */
<span class="lineNum">     269 </span>            : #define RTA_DNS         0x1000  /* DNS Servers sockaddr present */
<span class="lineNum">     270 </span>            : #define RTA_STATIC      0x2000  /* RFC 3442 encoded static routes present */
<span class="lineNum">     271 </span>            : #define RTA_SEARCH      0x4000  /* RFC 3397 encoded search path present */
<span class="lineNum">     272 </span>            : 
<span class="lineNum">     273 </span>            : /*
<span class="lineNum">     274 </span>            :  * Index offsets for sockaddr array for alternate internal encoding.
<span class="lineNum">     275 </span>            :  */
<span class="lineNum">     276 </span>            : #define RTAX_DST        0       /* destination sockaddr present */
<span class="lineNum">     277 </span>            : #define RTAX_GATEWAY    1       /* gateway sockaddr present */
<span class="lineNum">     278 </span>            : #define RTAX_NETMASK    2       /* netmask sockaddr present */
<span class="lineNum">     279 </span>            : #define RTAX_GENMASK    3       /* cloning mask sockaddr present */
<span class="lineNum">     280 </span>            : #define RTAX_IFP        4       /* interface name sockaddr present */
<span class="lineNum">     281 </span>            : #define RTAX_IFA        5       /* interface addr sockaddr present */
<span class="lineNum">     282 </span>            : #define RTAX_AUTHOR     6       /* sockaddr for author of redirect */
<span class="lineNum">     283 </span>            : #define RTAX_BRD        7       /* for NEWADDR, broadcast or p-p dest addr */
<span class="lineNum">     284 </span>            : #define RTAX_SRC        8       /* source sockaddr present */
<span class="lineNum">     285 </span>            : #define RTAX_SRCMASK    9       /* source netmask present */
<span class="lineNum">     286 </span>            : #define RTAX_LABEL      10      /* route label present */
<span class="lineNum">     287 </span>            : #define RTAX_BFD        11      /* bfd present */
<span class="lineNum">     288 </span>            : #define RTAX_DNS        12      /* DNS Server(s) sockaddr present */
<span class="lineNum">     289 </span>            : #define RTAX_STATIC     13      /* RFC 3442 encoded static routes present */
<span class="lineNum">     290 </span>            : #define RTAX_SEARCH     14      /* RFC 3397 encoded search path present */
<span class="lineNum">     291 </span>            : #define RTAX_MAX        15      /* size of array to allocate */
<span class="lineNum">     292 </span>            : 
<span class="lineNum">     293 </span>            : /*
<span class="lineNum">     294 </span>            :  * setsockopt defines used for the filtering.
<span class="lineNum">     295 </span>            :  */
<span class="lineNum">     296 </span>            : #define ROUTE_MSGFILTER 1       /* bitmask to specifiy which types should be
<span class="lineNum">     297 </span>            :                                    sent to the client. */
<span class="lineNum">     298 </span>            : #define ROUTE_TABLEFILTER 2     /* change routing table the socket is listening
<span class="lineNum">     299 </span>            :                                    on, RTABLE_ANY listens on all tables. */
<span class="lineNum">     300 </span>            : #define ROUTE_PRIOFILTER 3      /* only pass updates with a priority higher or
<span class="lineNum">     301 </span>            :                                    equal (actual value lower) to the specified
<span class="lineNum">     302 </span>            :                                    priority. */
<span class="lineNum">     303 </span>            : 
<span class="lineNum">     304 </span>            : #define ROUTE_FILTER(m) (1 &lt;&lt; (m))
<span class="lineNum">     305 </span>            : #define RTABLE_ANY      0xffffffff
<span class="lineNum">     306 </span>            : 
<span class="lineNum">     307 </span>            : #define RTLABEL_LEN     32
<span class="lineNum">     308 </span>            : 
<span class="lineNum">     309 </span>            : struct sockaddr_rtlabel {
<span class="lineNum">     310 </span>            :         u_int8_t        sr_len;                 /* total length */
<span class="lineNum">     311 </span>            :         sa_family_t     sr_family;              /* address family */
<span class="lineNum">     312 </span>            :         char            sr_label[RTLABEL_LEN];
<span class="lineNum">     313 </span>            : };
<span class="lineNum">     314 </span>            : 
<span class="lineNum">     315 </span>            : #define RTDNS_LEN       128
<span class="lineNum">     316 </span>            : 
<span class="lineNum">     317 </span>            : struct sockaddr_rtdns {
<span class="lineNum">     318 </span>            :         u_int8_t        sr_len;                 /* total length */
<span class="lineNum">     319 </span>            :         sa_family_t     sr_family;              /* address family */
<span class="lineNum">     320 </span>            :         char            sr_dns[RTDNS_LEN];
<span class="lineNum">     321 </span>            : };
<span class="lineNum">     322 </span>            : 
<span class="lineNum">     323 </span>            : #define RTSTATIC_LEN    128
<span class="lineNum">     324 </span>            : 
<span class="lineNum">     325 </span>            : struct sockaddr_rtstatic {
<span class="lineNum">     326 </span>            :         u_int8_t        sr_len;                 /* total length */
<span class="lineNum">     327 </span>            :         sa_family_t     sr_family;              /* address family */
<span class="lineNum">     328 </span>            :         char            sr_static[RTSTATIC_LEN];
<span class="lineNum">     329 </span>            : };
<span class="lineNum">     330 </span>            : 
<span class="lineNum">     331 </span>            : #define RTSEARCH_LEN    128
<span class="lineNum">     332 </span>            : 
<span class="lineNum">     333 </span>            : struct sockaddr_rtsearch {
<span class="lineNum">     334 </span>            :         u_int8_t        sr_len;                 /* total length */
<span class="lineNum">     335 </span>            :         sa_family_t     sr_family;              /* address family */
<span class="lineNum">     336 </span>            :         char            sr_search[RTSEARCH_LEN];
<span class="lineNum">     337 </span>            : };
<span class="lineNum">     338 </span>            : 
<span class="lineNum">     339 </span>            : /*
<span class="lineNum">     340 </span>            :  * A route consists of a destination address and a reference
<span class="lineNum">     341 </span>            :  * to a routing entry.  These are often held by protocols
<span class="lineNum">     342 </span>            :  * in their control blocks, e.g. inpcb.
<span class="lineNum">     343 </span>            :  */
<span class="lineNum">     344 </span>            : struct route {
<span class="lineNum">     345 </span>            :         struct  rtentry *ro_rt;
<span class="lineNum">     346 </span>            :         u_long           ro_tableid;    /* u_long because of alignment */
<span class="lineNum">     347 </span>            :         struct  sockaddr ro_dst;
<span class="lineNum">     348 </span>            : };
<span class="lineNum">     349 </span>            : 
<span class="lineNum">     350 </span>            : struct rt_addrinfo {
<span class="lineNum">     351 </span>            :         int     rti_addrs;
<span class="lineNum">     352 </span>            :         struct  sockaddr *rti_info[RTAX_MAX];
<span class="lineNum">     353 </span>            :         int     rti_flags;
<span class="lineNum">     354 </span>            :         struct  ifaddr *rti_ifa;
<span class="lineNum">     355 </span>            :         struct  rt_msghdr *rti_rtm;
<span class="lineNum">     356 </span>            :         u_char  rti_mpls;
<span class="lineNum">     357 </span>            : };
<span class="lineNum">     358 </span>            : 
<span class="lineNum">     359 </span>            : #ifdef _KERNEL
<span class="lineNum">     360 </span>            : 
<span class="lineNum">     361 </span>            : #include &lt;sys/percpu.h&gt;
<span class="lineNum">     362 </span>            : 
<span class="lineNum">     363 </span>            : enum rtstat_counters {
<span class="lineNum">     364 </span>            :         rts_badredirect,        /* bogus redirect calls */
<span class="lineNum">     365 </span>            :         rts_dynamic,            /* routes created by redirects */
<span class="lineNum">     366 </span>            :         rts_newgateway,         /* routes modified by redirects */
<span class="lineNum">     367 </span>            :         rts_unreach,            /* lookups which failed */
<span class="lineNum">     368 </span>            :         rts_wildcard,           /* lookups satisfied by a wildcard */
<span class="lineNum">     369 </span>            : 
<span class="lineNum">     370 </span>            :         rts_ncounters
<span class="lineNum">     371 </span>            : };
<a name="372"><span class="lineNum">     372 </span>            : </a>
<span class="lineNum">     373 </span>            : static inline void
<span class="lineNum">     374 </span><span class="lineNoCov">          0 : rtstat_inc(enum rtstat_counters c)</span>
<span class="lineNum">     375 </span>            : {
<span class="lineNum">     376 </span>            :         extern struct cpumem *rtcounters;
<span class="lineNum">     377 </span>            : 
<span class="lineNum">     378 </span><span class="lineNoCov">          0 :         counters_inc(rtcounters, c);</span>
<span class="lineNum">     379 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     380 </span>            : 
<span class="lineNum">     381 </span>            : /*
<span class="lineNum">     382 </span>            :  * This structure, and the prototypes for the rt_timer_{init,remove_all,
<span class="lineNum">     383 </span>            :  * add,timer} functions all used with the kind permission of BSDI.
<span class="lineNum">     384 </span>            :  * These allow functions to be called for routes at specific times.
<span class="lineNum">     385 </span>            :  */
<span class="lineNum">     386 </span>            : struct rttimer {
<span class="lineNum">     387 </span>            :         TAILQ_ENTRY(rttimer)    rtt_next;  /* entry on timer queue */
<span class="lineNum">     388 </span>            :         LIST_ENTRY(rttimer)     rtt_link;  /* multiple timers per rtentry */
<span class="lineNum">     389 </span>            :         struct rttimer_queue    *rtt_queue;/* back pointer to queue */
<span class="lineNum">     390 </span>            :         struct rtentry          *rtt_rt;   /* Back pointer to the route */
<span class="lineNum">     391 </span>            :         void                    (*rtt_func)(struct rtentry *,
<span class="lineNum">     392 </span>            :                                                  struct rttimer *);
<span class="lineNum">     393 </span>            :         time_t                  rtt_time; /* When this timer was registered */
<span class="lineNum">     394 </span>            :         u_int                   rtt_tableid;    /* routing table id of rtt_rt */
<span class="lineNum">     395 </span>            : };
<span class="lineNum">     396 </span>            : 
<span class="lineNum">     397 </span>            : struct rttimer_queue {
<span class="lineNum">     398 </span>            :         long                            rtq_timeout;
<span class="lineNum">     399 </span>            :         unsigned long                   rtq_count;
<span class="lineNum">     400 </span>            :         TAILQ_HEAD(, rttimer)           rtq_head;
<span class="lineNum">     401 </span>            :         LIST_ENTRY(rttimer_queue)       rtq_link;
<span class="lineNum">     402 </span>            : };
<span class="lineNum">     403 </span>            : 
<span class="lineNum">     404 </span>            : const char      *rtlabel_id2name(u_int16_t);
<span class="lineNum">     405 </span>            : u_int16_t        rtlabel_name2id(char *);
<span class="lineNum">     406 </span>            : struct sockaddr *rtlabel_id2sa(u_int16_t, struct sockaddr_rtlabel *);
<span class="lineNum">     407 </span>            : void             rtlabel_unref(u_int16_t);
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span>            : /*
<span class="lineNum">     410 </span>            :  * Values for additional argument to rtalloc()
<span class="lineNum">     411 </span>            :  */
<span class="lineNum">     412 </span>            : #define RT_RESOLVE      1
<span class="lineNum">     413 </span>            : 
<span class="lineNum">     414 </span>            : extern struct rtstat rtstat;
<span class="lineNum">     415 </span>            : 
<span class="lineNum">     416 </span>            : struct mbuf;
<span class="lineNum">     417 </span>            : struct socket;
<span class="lineNum">     418 </span>            : struct ifnet;
<span class="lineNum">     419 </span>            : struct sockaddr_in6;
<span class="lineNum">     420 </span>            : struct bfd_config;
<span class="lineNum">     421 </span>            : 
<span class="lineNum">     422 </span>            : void     route_init(void);
<span class="lineNum">     423 </span>            : void     rtm_ifchg(struct ifnet *);
<span class="lineNum">     424 </span>            : void     rtm_ifannounce(struct ifnet *, int);
<span class="lineNum">     425 </span>            : void     rtm_bfd(struct bfd_config *);
<span class="lineNum">     426 </span>            : void     rt_maskedcopy(struct sockaddr *,
<span class="lineNum">     427 </span>            :             struct sockaddr *, struct sockaddr *);
<span class="lineNum">     428 </span>            : struct sockaddr *rt_plen2mask(struct rtentry *, struct sockaddr_in6 *);
<span class="lineNum">     429 </span>            : void     rtm_send(struct rtentry *, int, int, unsigned int);
<span class="lineNum">     430 </span>            : void     rtm_addr(int, struct ifaddr *);
<span class="lineNum">     431 </span>            : void     rtm_miss(int, struct rt_addrinfo *, int, uint8_t, u_int, int, u_int);
<span class="lineNum">     432 </span>            : int      rt_setgate(struct rtentry *, struct sockaddr *, u_int);
<span class="lineNum">     433 </span>            : struct rtentry *rt_getll(struct rtentry *);
<span class="lineNum">     434 </span>            : 
<span class="lineNum">     435 </span>            : int                      rt_timer_add(struct rtentry *,
<span class="lineNum">     436 </span>            :                              void(*)(struct rtentry *, struct rttimer *),
<span class="lineNum">     437 </span>            :                              struct rttimer_queue *, u_int);
<span class="lineNum">     438 </span>            : void                     rt_timer_remove_all(struct rtentry *);
<span class="lineNum">     439 </span>            : struct rttimer_queue    *rt_timer_queue_create(u_int);
<span class="lineNum">     440 </span>            : void                     rt_timer_queue_change(struct rttimer_queue *, long);
<span class="lineNum">     441 </span>            : void                     rt_timer_queue_destroy(struct rttimer_queue *);
<span class="lineNum">     442 </span>            : unsigned long            rt_timer_queue_count(struct rttimer_queue *);
<span class="lineNum">     443 </span>            : void                     rt_timer_timer(void *);
<span class="lineNum">     444 </span>            : 
<span class="lineNum">     445 </span>            : int      rt_mpls_set(struct rtentry *, struct sockaddr *, uint8_t);
<span class="lineNum">     446 </span>            : void     rt_mpls_clear(struct rtentry *);
<span class="lineNum">     447 </span>            : 
<span class="lineNum">     448 </span>            : int      rtisvalid(struct rtentry *);
<span class="lineNum">     449 </span>            : int      rt_hash(struct rtentry *, struct sockaddr *, uint32_t *);
<span class="lineNum">     450 </span>            : struct   rtentry *rtalloc_mpath(struct sockaddr *, uint32_t *, u_int);
<span class="lineNum">     451 </span>            : struct   rtentry *rtalloc(struct sockaddr *, int, unsigned int);
<span class="lineNum">     452 </span>            : void     rtref(struct rtentry *);
<span class="lineNum">     453 </span>            : void     rtfree(struct rtentry *);
<span class="lineNum">     454 </span>            : 
<span class="lineNum">     455 </span>            : int      rt_ifa_add(struct ifaddr *, int, struct sockaddr *);
<span class="lineNum">     456 </span>            : int      rt_ifa_del(struct ifaddr *, int, struct sockaddr *);
<span class="lineNum">     457 </span>            : void     rt_ifa_purge(struct ifaddr *);
<span class="lineNum">     458 </span>            : int      rt_ifa_addlocal(struct ifaddr *);
<span class="lineNum">     459 </span>            : int      rt_ifa_dellocal(struct ifaddr *);
<span class="lineNum">     460 </span>            : void     rtredirect(struct sockaddr *, struct sockaddr *, struct sockaddr *, struct rtentry **, unsigned int);
<span class="lineNum">     461 </span>            : int      rtrequest(int, struct rt_addrinfo *, u_int8_t, struct rtentry **,
<span class="lineNum">     462 </span>            :              u_int);
<span class="lineNum">     463 </span>            : int      rtrequest_delete(struct rt_addrinfo *, u_int8_t, struct ifnet *,
<span class="lineNum">     464 </span>            :              struct rtentry **, u_int);
<span class="lineNum">     465 </span>            : void     rt_if_track(struct ifnet *);
<span class="lineNum">     466 </span>            : int      rt_if_linkstate_change(struct rtentry *, void *, u_int);
<span class="lineNum">     467 </span>            : int      rtdeletemsg(struct rtentry *, struct ifnet *, u_int);
<span class="lineNum">     468 </span>            : #endif /* _KERNEL */
<span class="lineNum">     469 </span>            : 
<span class="lineNum">     470 </span>            : #endif /* _NET_ROUTE_H_ */
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
