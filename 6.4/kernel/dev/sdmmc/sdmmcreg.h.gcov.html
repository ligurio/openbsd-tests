<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - 6.4 - dev/sdmmc/sdmmcreg.h</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">dev/sdmmc</a> - sdmmcreg.h<span style="font-size: 80%;"> (source / <a href="sdmmcreg.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">6.4</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">17</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2018-10-19 03:25:38</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*      $OpenBSD: sdmmcreg.h,v 1.11 2016/05/05 11:01:08 kettenis Exp $  */</a>
<span class="lineNum">       2 </span>            : 
<span class="lineNum">       3 </span>            : /*
<span class="lineNum">       4 </span>            :  * Copyright (c) 2006 Uwe Stuehler &lt;uwe@openbsd.org&gt;
<span class="lineNum">       5 </span>            :  *
<span class="lineNum">       6 </span>            :  * Permission to use, copy, modify, and distribute this software for any
<span class="lineNum">       7 </span>            :  * purpose with or without fee is hereby granted, provided that the above
<span class="lineNum">       8 </span>            :  * copyright notice and this permission notice appear in all copies.
<span class="lineNum">       9 </span>            :  *
<span class="lineNum">      10 </span>            :  * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES
<span class="lineNum">      11 </span>            :  * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
<span class="lineNum">      12 </span>            :  * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
<span class="lineNum">      13 </span>            :  * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
<span class="lineNum">      14 </span>            :  * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
<span class="lineNum">      15 </span>            :  * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
<span class="lineNum">      16 </span>            :  * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
<span class="lineNum">      17 </span>            :  */
<span class="lineNum">      18 </span>            : 
<span class="lineNum">      19 </span>            : #ifndef _SDMMCREG_H_
<span class="lineNum">      20 </span>            : #define _SDMMCREG_H_
<span class="lineNum">      21 </span>            : 
<span class="lineNum">      22 </span>            : /* MMC commands */                              /* response type */
<span class="lineNum">      23 </span>            : #define MMC_GO_IDLE_STATE               0       /* R0 */
<span class="lineNum">      24 </span>            : #define MMC_SEND_OP_COND                1       /* R3 */
<span class="lineNum">      25 </span>            : #define MMC_ALL_SEND_CID                2       /* R2 */
<span class="lineNum">      26 </span>            : #define MMC_SET_RELATIVE_ADDR           3       /* R1 */
<span class="lineNum">      27 </span>            : #define MMC_SWITCH                      6       /* R1B */
<span class="lineNum">      28 </span>            : #define MMC_SELECT_CARD                 7       /* R1 */
<span class="lineNum">      29 </span>            : #define MMC_SEND_EXT_CSD                8       /* R1 */
<span class="lineNum">      30 </span>            : #define MMC_SEND_CSD                    9       /* R2 */
<span class="lineNum">      31 </span>            : #define MMC_STOP_TRANSMISSION           12      /* R1B */
<span class="lineNum">      32 </span>            : #define MMC_SEND_STATUS                 13      /* R1 */
<span class="lineNum">      33 </span>            : #define MMC_SET_BLOCKLEN                16      /* R1 */
<span class="lineNum">      34 </span>            : #define MMC_READ_BLOCK_SINGLE           17      /* R1 */
<span class="lineNum">      35 </span>            : #define MMC_READ_BLOCK_MULTIPLE         18      /* R1 */
<span class="lineNum">      36 </span>            : #define MMC_SET_BLOCK_COUNT             23      /* R1 */
<span class="lineNum">      37 </span>            : #define MMC_WRITE_BLOCK_SINGLE          24      /* R1 */
<span class="lineNum">      38 </span>            : #define MMC_WRITE_BLOCK_MULTIPLE        25      /* R1 */
<span class="lineNum">      39 </span>            : #define MMC_APP_CMD                     55      /* R1 */
<span class="lineNum">      40 </span>            : 
<span class="lineNum">      41 </span>            : /* SD commands */                               /* response type */
<span class="lineNum">      42 </span>            : #define SD_SEND_RELATIVE_ADDR           3       /* R6 */
<span class="lineNum">      43 </span>            : #define SD_SEND_SWITCH_FUNC             6       /* R1 */
<span class="lineNum">      44 </span>            : #define SD_SEND_IF_COND                 8       /* R7 */
<span class="lineNum">      45 </span>            : 
<span class="lineNum">      46 </span>            : /* SD application commands */                   /* response type */
<span class="lineNum">      47 </span>            : #define SD_APP_SET_BUS_WIDTH            6       /* R1 */
<span class="lineNum">      48 </span>            : #define SD_APP_OP_COND                  41      /* R3 */
<span class="lineNum">      49 </span>            : #define SD_APP_SEND_SCR                 51      /* R1 */
<span class="lineNum">      50 </span>            : 
<span class="lineNum">      51 </span>            : /* OCR bits */
<span class="lineNum">      52 </span>            : #define MMC_OCR_MEM_READY               (1&lt;&lt;31)   /* memory power-up status bit */
<span class="lineNum">      53 </span>            : #define MMC_OCR_ACCESS_MODE_MASK        0x60000000 /* bits 30:29 */
<span class="lineNum">      54 </span>            : #define MMC_OCR_SECTOR_MODE             (1&lt;&lt;30)
<span class="lineNum">      55 </span>            : #define MMC_OCR_BYTE_MODE               (1&lt;&lt;29)
<span class="lineNum">      56 </span>            : #define MMC_OCR_3_5V_3_6V               (1&lt;&lt;23)
<span class="lineNum">      57 </span>            : #define MMC_OCR_3_4V_3_5V               (1&lt;&lt;22)
<span class="lineNum">      58 </span>            : #define MMC_OCR_3_3V_3_4V               (1&lt;&lt;21)
<span class="lineNum">      59 </span>            : #define MMC_OCR_3_2V_3_3V               (1&lt;&lt;20)
<span class="lineNum">      60 </span>            : #define MMC_OCR_3_1V_3_2V               (1&lt;&lt;19)
<span class="lineNum">      61 </span>            : #define MMC_OCR_3_0V_3_1V               (1&lt;&lt;18)
<span class="lineNum">      62 </span>            : #define MMC_OCR_2_9V_3_0V               (1&lt;&lt;17)
<span class="lineNum">      63 </span>            : #define MMC_OCR_2_8V_2_9V               (1&lt;&lt;16)
<span class="lineNum">      64 </span>            : #define MMC_OCR_2_7V_2_8V               (1&lt;&lt;15)
<span class="lineNum">      65 </span>            : #define MMC_OCR_2_6V_2_7V               (1&lt;&lt;14)
<span class="lineNum">      66 </span>            : #define MMC_OCR_2_5V_2_6V               (1&lt;&lt;13)
<span class="lineNum">      67 </span>            : #define MMC_OCR_2_4V_2_5V               (1&lt;&lt;12)
<span class="lineNum">      68 </span>            : #define MMC_OCR_2_3V_2_4V               (1&lt;&lt;11)
<span class="lineNum">      69 </span>            : #define MMC_OCR_2_2V_2_3V               (1&lt;&lt;10)
<span class="lineNum">      70 </span>            : #define MMC_OCR_2_1V_2_2V               (1&lt;&lt;9)
<span class="lineNum">      71 </span>            : #define MMC_OCR_2_0V_2_1V               (1&lt;&lt;8)
<span class="lineNum">      72 </span>            : #define MMC_OCR_1_65V_1_95V             (1&lt;&lt;7)
<span class="lineNum">      73 </span>            : 
<span class="lineNum">      74 </span>            : #define SD_OCR_SDHC_CAP                 (1&lt;&lt;30)
<span class="lineNum">      75 </span>            : #define SD_OCR_VOL_MASK                 0xFF8000 /* bits 23:15 */
<span class="lineNum">      76 </span>            : 
<span class="lineNum">      77 </span>            : /* R1 response type bits */
<span class="lineNum">      78 </span>            : #define MMC_R1_READY_FOR_DATA           (1&lt;&lt;8)    /* ready for next transfer */
<span class="lineNum">      79 </span>            : #define MMC_R1_APP_CMD                  (1&lt;&lt;5)    /* app. commands supported */
<span class="lineNum">      80 </span>            : 
<span class="lineNum">      81 </span>            : /* 48-bit response decoding (32 bits w/o CRC) */
<span class="lineNum">      82 </span>            : #define MMC_R1(resp)                    ((resp)[0])
<span class="lineNum">      83 </span>            : #define MMC_R3(resp)                    ((resp)[0])
<span class="lineNum">      84 </span>            : #define SD_R6(resp)                     ((resp)[0])
<span class="lineNum">      85 </span>            : 
<span class="lineNum">      86 </span>            : /* RCA argument and response */
<span class="lineNum">      87 </span>            : #define MMC_ARG_RCA(rca)                ((rca) &lt;&lt; 16)
<span class="lineNum">      88 </span>            : #define SD_R6_RCA(resp)                 (SD_R6((resp)) &gt;&gt; 16)
<span class="lineNum">      89 </span>            : 
<span class="lineNum">      90 </span>            : /* bus width argument */
<span class="lineNum">      91 </span>            : #define SD_ARG_BUS_WIDTH_1              0
<span class="lineNum">      92 </span>            : #define SD_ARG_BUS_WIDTH_4              2
<span class="lineNum">      93 </span>            : 
<span class="lineNum">      94 </span>            : /* EXT_CSD fields */
<span class="lineNum">      95 </span>            : #define EXT_CSD_BUS_WIDTH               183     /* WO */
<span class="lineNum">      96 </span>            : #define EXT_CSD_HS_TIMING               185     /* R/W */
<span class="lineNum">      97 </span>            : #define EXT_CSD_REV                     192     /* RO */
<span class="lineNum">      98 </span>            : #define EXT_CSD_STRUCTURE               194     /* RO */
<span class="lineNum">      99 </span>            : #define EXT_CSD_CARD_TYPE               196     /* RO */
<span class="lineNum">     100 </span>            : #define EXT_CSD_SEC_COUNT               212     /* RO */
<span class="lineNum">     101 </span>            : 
<span class="lineNum">     102 </span>            : /* EXT_CSD field definitions */
<span class="lineNum">     103 </span>            : #define EXT_CSD_CMD_SET_NORMAL          (1U &lt;&lt; 0)
<span class="lineNum">     104 </span>            : #define EXT_CSD_CMD_SET_SECURE          (1U &lt;&lt; 1)
<span class="lineNum">     105 </span>            : #define EXT_CSD_CMD_SET_CPSECURE        (1U &lt;&lt; 2)
<span class="lineNum">     106 </span>            : 
<span class="lineNum">     107 </span>            : /* EXT_CSD_HS_TIMING */
<span class="lineNum">     108 </span>            : #define EXT_CSD_HS_TIMING_BC            0
<span class="lineNum">     109 </span>            : #define EXT_CSD_HS_TIMING_HS            1
<span class="lineNum">     110 </span>            : #define EXT_CSD_HS_TIMING_HS200         2
<span class="lineNum">     111 </span>            : #define EXT_CSD_HS_TIMING_HS400         3
<span class="lineNum">     112 </span>            : 
<span class="lineNum">     113 </span>            : /* EXT_CSD_BUS_WIDTH  */
<span class="lineNum">     114 </span>            : #define EXT_CSD_BUS_WIDTH_1             0
<span class="lineNum">     115 </span>            : #define EXT_CSD_BUS_WIDTH_4             1
<span class="lineNum">     116 </span>            : #define EXT_CSD_BUS_WIDTH_8             2
<span class="lineNum">     117 </span>            : #define EXT_CSD_BUS_WIDTH_4_DDR         5
<span class="lineNum">     118 </span>            : #define EXT_CSD_BUS_WIDTH_8_DDR         6
<span class="lineNum">     119 </span>            : 
<span class="lineNum">     120 </span>            : /* EXT_CSD_CARD_TYPE */
<span class="lineNum">     121 </span>            : /* The only currently valid values for this field are 0x01, 0x03, 0x07,
<span class="lineNum">     122 </span>            :  * 0x0B and 0x0F. */
<span class="lineNum">     123 </span>            : #define EXT_CSD_CARD_TYPE_F_26M         (1 &lt;&lt; 0)
<span class="lineNum">     124 </span>            : #define EXT_CSD_CARD_TYPE_F_52M         (1 &lt;&lt; 1)
<span class="lineNum">     125 </span>            : #define EXT_CSD_CARD_TYPE_F_52M_1_8V    (1 &lt;&lt; 2)
<span class="lineNum">     126 </span>            : #define EXT_CSD_CARD_TYPE_F_52M_1_2V    (1 &lt;&lt; 3)
<span class="lineNum">     127 </span>            : #define EXT_CSD_CARD_TYPE_26M           0x01
<span class="lineNum">     128 </span>            : #define EXT_CSD_CARD_TYPE_52M           0x03
<span class="lineNum">     129 </span>            : #define EXT_CSD_CARD_TYPE_52M_V18       0x07
<span class="lineNum">     130 </span>            : #define EXT_CSD_CARD_TYPE_52M_V12       0x0b
<span class="lineNum">     131 </span>            : #define EXT_CSD_CARD_TYPE_52M_V12_18    0x0f
<span class="lineNum">     132 </span>            : 
<span class="lineNum">     133 </span>            : /* MMC_SWITCH access mode */
<span class="lineNum">     134 </span>            : #define MMC_SWITCH_MODE_CMD_SET         0x00    /* Change the command set */
<span class="lineNum">     135 </span>            : #define MMC_SWITCH_MODE_SET_BITS        0x01    /* Set bits in value */
<span class="lineNum">     136 </span>            : #define MMC_SWITCH_MODE_CLEAR_BITS      0x02    /* Clear bits in value */
<span class="lineNum">     137 </span>            : #define MMC_SWITCH_MODE_WRITE_BYTE      0x03    /* Set target to value */
<span class="lineNum">     138 </span>            : 
<span class="lineNum">     139 </span>            : /* MMC R2 response (CSD) */
<span class="lineNum">     140 </span>            : #define MMC_CSD_CSDVER(resp)            MMC_RSP_BITS((resp), 126, 2)
<span class="lineNum">     141 </span>            : #define  MMC_CSD_CSDVER_1_0             1
<span class="lineNum">     142 </span>            : #define  MMC_CSD_CSDVER_2_0             2
<span class="lineNum">     143 </span>            : #define  MMC_CSD_CSDVER_EXT_CSD         3
<span class="lineNum">     144 </span>            : #define MMC_CSD_MMCVER(resp)            MMC_RSP_BITS((resp), 122, 4)
<span class="lineNum">     145 </span>            : #define  MMC_CSD_MMCVER_1_0             0 /* MMC 1.0 - 1.2 */
<span class="lineNum">     146 </span>            : #define  MMC_CSD_MMCVER_1_4             1 /* MMC 1.4 */
<span class="lineNum">     147 </span>            : #define  MMC_CSD_MMCVER_2_0             2 /* MMC 2.0 - 2.2 */
<span class="lineNum">     148 </span>            : #define  MMC_CSD_MMCVER_3_1             3 /* MMC 3.1 - 3.3 */
<span class="lineNum">     149 </span>            : #define  MMC_CSD_MMCVER_4_0             4 /* MMC 4 */
<span class="lineNum">     150 </span>            : #define MMC_CSD_READ_BL_LEN(resp)       MMC_RSP_BITS((resp), 80, 4)
<span class="lineNum">     151 </span>            : #define MMC_CSD_C_SIZE(resp)            MMC_RSP_BITS((resp), 62, 12)
<span class="lineNum">     152 </span>            : #define MMC_CSD_CAPACITY(resp)          ((MMC_CSD_C_SIZE((resp))+1) &lt;&lt; \
<span class="lineNum">     153 </span>            :                                          (MMC_CSD_C_SIZE_MULT((resp))+2))
<span class="lineNum">     154 </span>            : #define MMC_CSD_C_SIZE_MULT(resp)       MMC_RSP_BITS((resp), 47, 3)
<span class="lineNum">     155 </span>            : 
<span class="lineNum">     156 </span>            : /* MMC v1 R2 response (CID) */
<span class="lineNum">     157 </span>            : #define MMC_CID_MID_V1(resp)            MMC_RSP_BITS((resp), 104, 24)
<span class="lineNum">     158 </span>            : #define MMC_CID_PNM_V1_CPY(resp, pnm)                                   \
<span class="lineNum">     159 </span>            :         do {                                                            \
<span class="lineNum">     160 </span>            :                 (pnm)[0] = MMC_RSP_BITS((resp), 96, 8);                 \
<span class="lineNum">     161 </span>            :                 (pnm)[1] = MMC_RSP_BITS((resp), 88, 8);                 \
<span class="lineNum">     162 </span>            :                 (pnm)[2] = MMC_RSP_BITS((resp), 80, 8);                 \
<span class="lineNum">     163 </span>            :                 (pnm)[3] = MMC_RSP_BITS((resp), 72, 8);                 \
<span class="lineNum">     164 </span>            :                 (pnm)[4] = MMC_RSP_BITS((resp), 64, 8);                 \
<span class="lineNum">     165 </span>            :                 (pnm)[5] = MMC_RSP_BITS((resp), 56, 8);                 \
<span class="lineNum">     166 </span>            :                 (pnm)[6] = MMC_RSP_BITS((resp), 48, 8);                 \
<span class="lineNum">     167 </span>            :                 (pnm)[7] = '\0';                                        \
<span class="lineNum">     168 </span>            :         } while (0)
<span class="lineNum">     169 </span>            : #define MMC_CID_REV_V1(resp)            MMC_RSP_BITS((resp), 40, 8)
<span class="lineNum">     170 </span>            : #define MMC_CID_PSN_V1(resp)            MMC_RSP_BITS((resp), 16, 24)
<span class="lineNum">     171 </span>            : #define MMC_CID_MDT_V1(resp)            MMC_RSP_BITS((resp), 8, 8)
<span class="lineNum">     172 </span>            : 
<span class="lineNum">     173 </span>            : /* MMC v2 R2 response (CID) */
<span class="lineNum">     174 </span>            : #define MMC_CID_MID_V2(resp)            MMC_RSP_BITS((resp), 120, 8)
<span class="lineNum">     175 </span>            : #define MMC_CID_OID_V2(resp)            MMC_RSP_BITS((resp), 104, 16)
<span class="lineNum">     176 </span>            : #define MMC_CID_PNM_V2_CPY(resp, pnm)                                   \
<span class="lineNum">     177 </span>            :         do {                                                            \
<span class="lineNum">     178 </span>            :                 (pnm)[0] = MMC_RSP_BITS((resp), 96, 8);                 \
<span class="lineNum">     179 </span>            :                 (pnm)[1] = MMC_RSP_BITS((resp), 88, 8);                 \
<span class="lineNum">     180 </span>            :                 (pnm)[2] = MMC_RSP_BITS((resp), 80, 8);                 \
<span class="lineNum">     181 </span>            :                 (pnm)[3] = MMC_RSP_BITS((resp), 72, 8);                 \
<span class="lineNum">     182 </span>            :                 (pnm)[4] = MMC_RSP_BITS((resp), 64, 8);                 \
<span class="lineNum">     183 </span>            :                 (pnm)[5] = MMC_RSP_BITS((resp), 56, 8);                 \
<span class="lineNum">     184 </span>            :                 (pnm)[6] = '\0';                                        \
<span class="lineNum">     185 </span>            :         } while (0)
<span class="lineNum">     186 </span>            : #define MMC_CID_PSN_V2(resp)            MMC_RSP_BITS((resp), 16, 32)
<span class="lineNum">     187 </span>            : 
<span class="lineNum">     188 </span>            : /* SD R2 response (CSD) */
<span class="lineNum">     189 </span>            : #define SD_CSD_CSDVER(resp)             MMC_RSP_BITS((resp), 126, 2)
<span class="lineNum">     190 </span>            : #define  SD_CSD_CSDVER_1_0              0
<span class="lineNum">     191 </span>            : #define  SD_CSD_CSDVER_2_0              1
<span class="lineNum">     192 </span>            : #define SD_CSD_TAAC(resp)               MMC_RSP_BITS((resp), 112, 8)
<span class="lineNum">     193 </span>            : #define  SD_CSD_TAAC_1_5_MSEC           0x26
<span class="lineNum">     194 </span>            : #define SD_CSD_NSAC(resp)               MMC_RSP_BITS((resp), 104, 8)
<span class="lineNum">     195 </span>            : #define SD_CSD_SPEED(resp)              MMC_RSP_BITS((resp), 96, 8)
<span class="lineNum">     196 </span>            : #define  SD_CSD_SPEED_25_MHZ            0x32
<span class="lineNum">     197 </span>            : #define  SD_CSD_SPEED_50_MHZ            0x5a
<span class="lineNum">     198 </span>            : #define SD_CSD_CCC(resp)                MMC_RSP_BITS((resp), 84, 12)
<span class="lineNum">     199 </span>            : #define  SD_CSD_CCC_BASIC               (1 &lt;&lt; 0)  /* basic */
<span class="lineNum">     200 </span>            : #define  SD_CSD_CCC_BR                  (1 &lt;&lt; 2)  /* block read */
<span class="lineNum">     201 </span>            : #define  SD_CSD_CCC_BW                  (1 &lt;&lt; 4)  /* block write */
<span class="lineNum">     202 </span>            : #define  SD_CSD_CCC_ERACE               (1 &lt;&lt; 5)  /* erase */
<span class="lineNum">     203 </span>            : #define  SD_CSD_CCC_WP                  (1 &lt;&lt; 6)  /* write protection */
<span class="lineNum">     204 </span>            : #define  SD_CSD_CCC_LC                  (1 &lt;&lt; 7)  /* lock card */
<span class="lineNum">     205 </span>            : #define  SD_CSD_CCC_AS                  (1 &lt;&lt; 8)  /*application specific*/
<span class="lineNum">     206 </span>            : #define  SD_CSD_CCC_IOM                 (1 &lt;&lt; 9)  /* I/O mode */
<span class="lineNum">     207 </span>            : #define  SD_CSD_CCC_SWITCH              (1 &lt;&lt; 10) /* switch */
<span class="lineNum">     208 </span>            : #define SD_CSD_READ_BL_LEN(resp)        MMC_RSP_BITS((resp), 80, 4)
<span class="lineNum">     209 </span>            : #define SD_CSD_READ_BL_PARTIAL(resp)    MMC_RSP_BITS((resp), 79, 1)
<span class="lineNum">     210 </span>            : #define SD_CSD_WRITE_BLK_MISALIGN(resp) MMC_RSP_BITS((resp), 78, 1)
<span class="lineNum">     211 </span>            : #define SD_CSD_READ_BLK_MISALIGN(resp)  MMC_RSP_BITS((resp), 77, 1)
<span class="lineNum">     212 </span>            : #define SD_CSD_DSR_IMP(resp)            MMC_RSP_BITS((resp), 76, 1)
<span class="lineNum">     213 </span>            : #define SD_CSD_C_SIZE(resp)             MMC_RSP_BITS((resp), 62, 12)
<span class="lineNum">     214 </span>            : #define SD_CSD_CAPACITY(resp)           ((SD_CSD_C_SIZE((resp))+1) &lt;&lt; \
<span class="lineNum">     215 </span>            :                                          (SD_CSD_C_SIZE_MULT((resp))+2))
<span class="lineNum">     216 </span>            : #define SD_CSD_V2_C_SIZE(resp)          MMC_RSP_BITS((resp), 48, 22)
<span class="lineNum">     217 </span>            : #define SD_CSD_V2_CAPACITY(resp)        ((SD_CSD_V2_C_SIZE((resp))+1) &lt;&lt; 10) 
<span class="lineNum">     218 </span>            : #define SD_CSD_V2_BL_LEN                0x9     /* 512 */
<span class="lineNum">     219 </span>            : #define SD_CSD_VDD_R_CURR_MIN(resp)     MMC_RSP_BITS((resp), 59, 3)
<span class="lineNum">     220 </span>            : #define SD_CSD_VDD_R_CURR_MAX(resp)     MMC_RSP_BITS((resp), 56, 3)
<span class="lineNum">     221 </span>            : #define SD_CSD_VDD_W_CURR_MIN(resp)     MMC_RSP_BITS((resp), 53, 3)
<span class="lineNum">     222 </span>            : #define SD_CSD_VDD_W_CURR_MAX(resp)     MMC_RSP_BITS((resp), 50, 3)
<span class="lineNum">     223 </span>            : #define  SD_CSD_VDD_RW_CURR_100mA       0x7
<span class="lineNum">     224 </span>            : #define  SD_CSD_VDD_RW_CURR_80mA        0x6
<span class="lineNum">     225 </span>            : #define SD_CSD_C_SIZE_MULT(resp)        MMC_RSP_BITS((resp), 47, 3)
<span class="lineNum">     226 </span>            : #define SD_CSD_ERASE_BLK_EN(resp)       MMC_RSP_BITS((resp), 46, 1)
<span class="lineNum">     227 </span>            : #define SD_CSD_SECTOR_SIZE(resp)        MMC_RSP_BITS((resp), 39, 7) /* +1 */
<span class="lineNum">     228 </span>            : #define SD_CSD_WP_GRP_SIZE(resp)        MMC_RSP_BITS((resp), 32, 7) /* +1 */
<span class="lineNum">     229 </span>            : #define SD_CSD_WP_GRP_ENABLE(resp)      MMC_RSP_BITS((resp), 31, 1)
<span class="lineNum">     230 </span>            : #define SD_CSD_R2W_FACTOR(resp)         MMC_RSP_BITS((resp), 26, 3)
<span class="lineNum">     231 </span>            : #define SD_CSD_WRITE_BL_LEN(resp)       MMC_RSP_BITS((resp), 22, 4)
<span class="lineNum">     232 </span>            : #define  SD_CSD_RW_BL_LEN_2G            0xa
<span class="lineNum">     233 </span>            : #define  SD_CSD_RW_BL_LEN_1G            0x9
<span class="lineNum">     234 </span>            : #define SD_CSD_WRITE_BL_PARTIAL(resp)   MMC_RSP_BITS((resp), 21, 1)
<span class="lineNum">     235 </span>            : #define SD_CSD_FILE_FORMAT_GRP(resp)    MMC_RSP_BITS((resp), 15, 1)
<span class="lineNum">     236 </span>            : #define SD_CSD_COPY(resp)               MMC_RSP_BITS((resp), 14, 1)
<span class="lineNum">     237 </span>            : #define SD_CSD_PERM_WRITE_PROTECT(resp) MMC_RSP_BITS((resp), 13, 1)
<span class="lineNum">     238 </span>            : #define SD_CSD_TMP_WRITE_PROTECT(resp)  MMC_RSP_BITS((resp), 12, 1)
<span class="lineNum">     239 </span>            : #define SD_CSD_FILE_FORMAT(resp)        MMC_RSP_BITS((resp), 10, 2)
<span class="lineNum">     240 </span>            : 
<span class="lineNum">     241 </span>            : /* SD R2 response (CID) */
<span class="lineNum">     242 </span>            : #define SD_CID_MID(resp)                MMC_RSP_BITS((resp), 120, 8)
<span class="lineNum">     243 </span>            : #define SD_CID_OID(resp)                MMC_RSP_BITS((resp), 104, 16)
<span class="lineNum">     244 </span>            : #define SD_CID_PNM_CPY(resp, pnm)                                       \
<span class="lineNum">     245 </span>            :         do {                                                            \
<span class="lineNum">     246 </span>            :                 (pnm)[0] = MMC_RSP_BITS((resp), 96, 8);                 \
<span class="lineNum">     247 </span>            :                 (pnm)[1] = MMC_RSP_BITS((resp), 88, 8);                 \
<span class="lineNum">     248 </span>            :                 (pnm)[2] = MMC_RSP_BITS((resp), 80, 8);                 \
<span class="lineNum">     249 </span>            :                 (pnm)[3] = MMC_RSP_BITS((resp), 72, 8);                 \
<span class="lineNum">     250 </span>            :                 (pnm)[4] = MMC_RSP_BITS((resp), 64, 8);                 \
<span class="lineNum">     251 </span>            :                 (pnm)[5] = '\0';                                        \
<span class="lineNum">     252 </span>            :         } while (0)
<span class="lineNum">     253 </span>            : #define SD_CID_REV(resp)                MMC_RSP_BITS((resp), 56, 8)
<span class="lineNum">     254 </span>            : #define SD_CID_PSN(resp)                MMC_RSP_BITS((resp), 24, 32)
<span class="lineNum">     255 </span>            : #define SD_CID_MDT(resp)                MMC_RSP_BITS((resp), 8, 12)
<span class="lineNum">     256 </span>            : 
<span class="lineNum">     257 </span>            : /* SCR (SD Configuration Register) */
<span class="lineNum">     258 </span>            : #define SCR_STRUCTURE(scr)              MMC_RSP_BITS((scr), 60, 4)
<span class="lineNum">     259 </span>            : #define  SCR_STRUCTURE_VER_1_0          0 /* Version 1.0 */
<span class="lineNum">     260 </span>            : #define SCR_SD_SPEC(scr)                MMC_RSP_BITS((scr), 56, 4)
<span class="lineNum">     261 </span>            : #define  SCR_SD_SPEC_VER_1_0            0 /* Version 1.0 and 1.01 */
<span class="lineNum">     262 </span>            : #define  SCR_SD_SPEC_VER_1_10           1 /* Version 1.10 */
<span class="lineNum">     263 </span>            : #define  SCR_SD_SPEC_VER_2              2 /* Version 2.00 or Version 3.0X */
<span class="lineNum">     264 </span>            : #define SCR_DATA_STAT_AFTER_ERASE(scr)  MMC_RSP_BITS((scr), 55, 1)
<span class="lineNum">     265 </span>            : #define SCR_SD_SECURITY(scr)            MMC_RSP_BITS((scr), 52, 3)
<span class="lineNum">     266 </span>            : #define  SCR_SD_SECURITY_NONE           0 /* no security */
<span class="lineNum">     267 </span>            : #define  SCR_SD_SECURITY_1_0            1 /* security protocol 1.0 */
<span class="lineNum">     268 </span>            : #define  SCR_SD_SECURITY_1_0_2          2 /* security protocol 1.0 */
<span class="lineNum">     269 </span>            : #define SCR_SD_BUS_WIDTHS(scr)          MMC_RSP_BITS((scr), 48, 4)
<span class="lineNum">     270 </span>            : #define  SCR_SD_BUS_WIDTHS_1BIT         (1 &lt;&lt; 0) /* 1bit (DAT0) */
<span class="lineNum">     271 </span>            : #define  SCR_SD_BUS_WIDTHS_4BIT         (1 &lt;&lt; 2) /* 4bit (DAT0-3) */
<span class="lineNum">     272 </span>            : #define SCR_SD_SPEC3(scr)               MMC_RSP_BITS((scr), 47, 1)
<span class="lineNum">     273 </span>            : #define SCR_EX_SECURITY(scr)            MMC_RSP_BITS((scr), 43, 4)
<span class="lineNum">     274 </span>            : #define SCR_SD_SPEC4(scr)               MMC_RSP_BITS((scr), 42, 1)
<span class="lineNum">     275 </span>            : #define SCR_RESERVED(scr)               MMC_RSP_BITS((scr), 34, 8)
<span class="lineNum">     276 </span>            : #define SCR_CMD_SUPPORT_CMD23(scr)      MMC_RSP_BITS((scr), 33, 1)
<span class="lineNum">     277 </span>            : #define SCR_CMD_SUPPORT_CMD20(scr)      MMC_RSP_BITS((scr), 32, 1)
<span class="lineNum">     278 </span>            : #define SCR_RESERVED2(scr)              MMC_RSP_BITS((scr), 0, 32)
<span class="lineNum">     279 </span>            : 
<span class="lineNum">     280 </span>            : /* Status of Switch Function */
<span class="lineNum">     281 </span>            : #define SFUNC_STATUS_GROUP(status, group) \
<span class="lineNum">     282 </span>            :         (__bitfield((uint32_t *)(status), 400 + (group - 1) * 16, 16))
<span class="lineNum">     283 </span>            : 
<span class="lineNum">     284 </span>            : #define SD_ACCESS_MODE_SDR12    0
<span class="lineNum">     285 </span>            : #define SD_ACCESS_MODE_SDR25    1
<span class="lineNum">     286 </span>            : #define SD_ACCESS_MODE_SDR50    2
<span class="lineNum">     287 </span>            : #define SD_ACCESS_MODE_SDR104   3
<span class="lineNum">     288 </span>            : #define SD_ACCESS_MODE_DDR50    4
<span class="lineNum">     289 </span>            : 
<span class="lineNum">     290 </span>            : /* Might be slow, but it should work on big and little endian systems. */
<a name="291"><span class="lineNum">     291 </span>            : #define MMC_RSP_BITS(resp, start, len)  __bitfield((resp), (start)-8, (len))</a>
<span class="lineNum">     292 </span>            : static __inline int
<span class="lineNum">     293 </span><span class="lineNoCov">          0 : __bitfield(u_int32_t *src, int start, int len)</span>
<span class="lineNum">     294 </span>            : {
<span class="lineNum">     295 </span>            :         u_int8_t *sp;
<span class="lineNum">     296 </span>            :         u_int32_t dst, mask;
<span class="lineNum">     297 </span>            :         int shift, bs, bc;
<span class="lineNum">     298 </span>            : 
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :         if (start &lt; 0 || len &lt; 0 || len &gt; 32)</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :                 return 0;</span>
<span class="lineNum">     301 </span>            : 
<span class="lineNum">     302 </span>            :         dst = 0;
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :         mask = len % 32 ? UINT_MAX &gt;&gt; (32 - (len % 32)) : UINT_MAX;</span>
<span class="lineNum">     304 </span>            :         shift = 0;
<span class="lineNum">     305 </span>            : 
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :         while (len &gt; 0) {</span>
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :                 sp = (u_int8_t *)src + start / 8;</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :                 bs = start % 8;</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :                 bc = 8 - bs;</span>
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :                 if (bc &gt; len)</span>
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :                         bc = len;</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :                 dst |= (*sp++ &gt;&gt; bs) &lt;&lt; shift;</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :                 shift += bc;</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :                 start += bc;</span>
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :                 len -= bc;</span>
<span class="lineNum">     316 </span>            :         }
<span class="lineNum">     317 </span>            : 
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :         dst &amp;= mask;</span>
<span class="lineNum">     319 </span><span class="lineNoCov">          0 :         return (int)dst;</span>
<span class="lineNum">     320 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     321 </span>            : 
<span class="lineNum">     322 </span>            : #endif
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
